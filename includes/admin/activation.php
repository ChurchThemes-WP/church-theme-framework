<?php/** * Theme Activation *//** * Homepage Setup * * Find or add homepage with proper template then set as static front page */function ctc_set_homepage( $template, $title, $content ) {	// Does page using homepage template already exist?	$pages = get_pages( array( // only gets published pages		'meta_key' => '_wp_page_template',		'meta_value' => $template,		'sort_column' => 'ID',		'sort_order' => 'DESC', // if more than one, gets the newest		'number' => 1	) );	$homepage_page_id = ! empty( $pages[0]->ID ) ? $pages[0]->ID : false; // get ID so can set as front page	// No proper homepage found so add one with sample content	if ( empty( $homepage_page_id ) ) {		// Insert the post into the database		$current_user = wp_get_current_user();		$homepage_page_id = wp_insert_post( array(			'post_name'			=> 'homepage', // if already exists, WordPress will append number			'post_type'			=> 'page',			'post_status'		=> 'publish',			'post_author'		=> $current_user->ID,			'comment_status'	=> 'closed',			'ping_status'		=> 'closed',			'post_title'		=> $title,			'post_content'		=> $content,		) );		// Set page template		if ( ! empty( $homepage_page_id ) ) {			update_post_meta( $homepage_page_id, '_wp_page_template', $template );		}			}	// Set static front page	if ( ! empty( $homepage_page_id ) ) { // homepage found or added successfully		$show_on_front = 'page';		$page_on_front = $homepage_page_id;	} else { // if no homepage found or made, revert to show posts on homepage		$show_on_front = 'posts';		$page_on_front = '';			}	update_option( 'show_on_front', $show_on_front );	update_option( 'page_on_front', $page_on_front );	}/** * Flush Rewrite Rules * * Flush rewrite rules after other things are done, such as registering custom post types, taxonomies, etc. */// Run this on activation in themefunction ctc_activate_flush_rewrite_rules() {	add_action( 'init', 'ctc_flush_rewrite_rules', 11 ); // after standard init at 10}// Do the actual flush called for abovefunction ctc_flush_rewrite_rules() {	flush_rewrite_rules();}